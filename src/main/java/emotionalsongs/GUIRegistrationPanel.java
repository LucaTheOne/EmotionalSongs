/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package emotionalsongs;

import java.awt.*;
import java.io.*;
import javax.swing.*;

/**
 *
 * @author Megaport
 */
public class GUIRegistrationPanel extends javax.swing.JPanel {
    
    GUIMainFrame mainWindow = EMOTIONALSONGS.mainWindow;

    /**
     * Creates new form GUIRegistrationPanel
     */
    public GUIRegistrationPanel() {
        initComponents();
    }
    
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        mainPanel = new JPanel(){
            @Override
            protected void paintComponent(Graphics g){
                Graphics g2 = g.create();
                g2.drawImage(Utilities.regBG.getImage(), 0, 0, getWidth(), getHeight(), null);
                g2.dispose();
            }
        };
        jPanel3 = new javax.swing.JPanel();
        iconPanel = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        mainGridPanel = new javax.swing.JPanel();
        labelsPanel = new javax.swing.JPanel();
        nomeLabel = new javax.swing.JLabel();
        cognomeLabel = new javax.swing.JLabel();
        indirizzoLabel = new javax.swing.JLabel();
        cfLabel = new javax.swing.JLabel();
        dataDiNascitaLabel = new javax.swing.JLabel();
        mailLabel = new javax.swing.JLabel();
        idLabel = new javax.swing.JLabel();
        textFieldsLabel = new javax.swing.JPanel();
        nomeTextField = new javax.swing.JTextField();
        cognomeTextField = new javax.swing.JTextField();
        indirizzoTextField = new javax.swing.JTextField();
        dataDiNascitaTextField = new javax.swing.JTextField();
        cfTextField = new javax.swing.JTextField();
        mailTextField = new javax.swing.JTextField();
        idTextField = new javax.swing.JTextField();
        warningLabelsPanel = new javax.swing.JPanel();
        nomeCheckLabel = new javax.swing.JLabel();
        cognomeCheckLabel = new javax.swing.JLabel();
        indirizzoCheckLabel = new javax.swing.JLabel();
        dataDiNascitaCheckLabel = new javax.swing.JLabel();
        cfCheckLabel = new javax.swing.JLabel();
        mailCheckLabel = new javax.swing.JLabel();
        idCheckLabel = new javax.swing.JLabel();
        lowPanel = new javax.swing.JPanel();
        passwordPanel = new javax.swing.JPanel();
        passwordLabel = new javax.swing.JLabel();
        passwordTextField = new javax.swing.JPasswordField();
        controlloLabel = new javax.swing.JLabel();
        controlloTextField = new javax.swing.JPasswordField();
        passwordCheckLabel = new javax.swing.JLabel();
        buttonsPanel = new javax.swing.JPanel();
        registratiButton = new javax.swing.JButton();
        closeButton = new javax.swing.JButton();

        setPreferredSize(new java.awt.Dimension(600, 600));
        setLayout(new java.awt.BorderLayout());

        mainPanel.setLayout(new java.awt.BorderLayout());

        jPanel3.setOpaque(false);
        jPanel3.setPreferredSize(new java.awt.Dimension(200, 100));
        jPanel3.setLayout(new java.awt.BorderLayout());

        iconPanel.setOpaque(false);
        iconPanel.setPreferredSize(new java.awt.Dimension(100, 250));
        iconPanel.setSize(new java.awt.Dimension(100, 200));
        iconPanel.setLayout(new java.awt.GridLayout(1, 3));
        iconPanel.add(jLabel1);

        jLabel3.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel3.setIcon(Utilities.regIcon);
        iconPanel.add(jLabel3);
        iconPanel.add(jLabel2);

        jPanel3.add(iconPanel, java.awt.BorderLayout.PAGE_START);

        mainGridPanel.setOpaque(false);
        mainGridPanel.setLayout(new java.awt.GridLayout(1, 3));

        labelsPanel.setOpaque(false);
        labelsPanel.setLayout(new java.awt.GridLayout(7, 1));

        nomeLabel.setFont(new java.awt.Font("Helvetica Neue", 0, 18)); // NOI18N
        nomeLabel.setForeground(new java.awt.Color(255, 255, 255));
        nomeLabel.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
        nomeLabel.setText("NOME    ");
        nomeLabel.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        labelsPanel.add(nomeLabel);

        cognomeLabel.setFont(new java.awt.Font("Helvetica Neue", 0, 18)); // NOI18N
        cognomeLabel.setForeground(new java.awt.Color(255, 255, 255));
        cognomeLabel.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
        cognomeLabel.setText("COGNOME    ");
        cognomeLabel.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        labelsPanel.add(cognomeLabel);

        indirizzoLabel.setFont(new java.awt.Font("Helvetica Neue", 0, 18)); // NOI18N
        indirizzoLabel.setForeground(new java.awt.Color(255, 255, 255));
        indirizzoLabel.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
        indirizzoLabel.setText("INDIRIZZO    ");
        indirizzoLabel.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        labelsPanel.add(indirizzoLabel);

        cfLabel.setFont(new java.awt.Font("Helvetica Neue", 0, 18)); // NOI18N
        cfLabel.setForeground(new java.awt.Color(255, 255, 255));
        cfLabel.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
        cfLabel.setText("CODICE FISCALE    ");
        cfLabel.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        labelsPanel.add(cfLabel);

        dataDiNascitaLabel.setFont(new java.awt.Font("Helvetica Neue", 0, 18)); // NOI18N
        dataDiNascitaLabel.setForeground(new java.awt.Color(255, 255, 255));
        dataDiNascitaLabel.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
        dataDiNascitaLabel.setText("DATA DI NASCITA    ");
        dataDiNascitaLabel.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        labelsPanel.add(dataDiNascitaLabel);

        mailLabel.setFont(new java.awt.Font("Helvetica Neue", 0, 18)); // NOI18N
        mailLabel.setForeground(new java.awt.Color(255, 255, 255));
        mailLabel.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
        mailLabel.setText("INDIRIZZO E-MAIL    ");
        mailLabel.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        labelsPanel.add(mailLabel);

        idLabel.setFont(new java.awt.Font("Helvetica Neue", 0, 18)); // NOI18N
        idLabel.setForeground(new java.awt.Color(255, 255, 255));
        idLabel.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
        idLabel.setText("USER ID    ");
        idLabel.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        labelsPanel.add(idLabel);

        mainGridPanel.add(labelsPanel);

        textFieldsLabel.setOpaque(false);
        textFieldsLabel.setLayout(new java.awt.GridLayout(7, 1));

        nomeTextField.setPreferredSize(new java.awt.Dimension(350, 30));
        textFieldsLabel.add(nomeTextField);

        cognomeTextField.setPreferredSize(new java.awt.Dimension(350, 30));
        textFieldsLabel.add(cognomeTextField);

        indirizzoTextField.setPreferredSize(new java.awt.Dimension(400, 30));
        textFieldsLabel.add(indirizzoTextField);

        dataDiNascitaTextField.setPreferredSize(new java.awt.Dimension(350, 30));
        textFieldsLabel.add(dataDiNascitaTextField);

        cfTextField.setPreferredSize(new java.awt.Dimension(350, 30));
        textFieldsLabel.add(cfTextField);

        mailTextField.setPreferredSize(new java.awt.Dimension(350, 30));
        textFieldsLabel.add(mailTextField);

        idTextField.setPreferredSize(new java.awt.Dimension(350, 30));
        textFieldsLabel.add(idTextField);

        mainGridPanel.add(textFieldsLabel);

        warningLabelsPanel.setOpaque(false);
        warningLabelsPanel.setLayout(new java.awt.GridLayout(7, 1));

        nomeCheckLabel.setVisible(false);
        nomeCheckLabel.setFont(new java.awt.Font("Helvetica Neue", 1, 15)); // NOI18N
        nomeCheckLabel.setForeground(new java.awt.Color(255, 51, 51));
        nomeCheckLabel.setText("    Nome non valido!");
        warningLabelsPanel.add(nomeCheckLabel);

        cognomeCheckLabel.setVisible(false);
        cognomeCheckLabel.setFont(new java.awt.Font("Helvetica Neue", 1, 15)); // NOI18N
        cognomeCheckLabel.setForeground(new java.awt.Color(255, 51, 51));
        cognomeCheckLabel.setText("    Cognome non valido!");
        warningLabelsPanel.add(cognomeCheckLabel);

        indirizzoCheckLabel.setVisible(false);
        indirizzoCheckLabel.setFont(new java.awt.Font("Helvetica Neue", 1, 15)); // NOI18N
        indirizzoCheckLabel.setForeground(new java.awt.Color(255, 51, 51));
        indirizzoCheckLabel.setText("    Questo campo non può essere vuoto!");
        warningLabelsPanel.add(indirizzoCheckLabel);

        dataDiNascitaCheckLabel.setVisible(false);
        dataDiNascitaCheckLabel.setFont(new java.awt.Font("Helvetica Neue", 1, 15)); // NOI18N
        dataDiNascitaCheckLabel.setForeground(new java.awt.Color(255, 51, 51));
        dataDiNascitaCheckLabel.setText("    Formato data non valido!");
        warningLabelsPanel.add(dataDiNascitaCheckLabel);

        cfCheckLabel.setVisible(false);
        cfCheckLabel.setFont(new java.awt.Font("Helvetica Neue", 1, 15)); // NOI18N
        cfCheckLabel.setForeground(new java.awt.Color(255, 51, 51));
        cfCheckLabel.setText("    Formato data non valido!");
        warningLabelsPanel.add(cfCheckLabel);

        mailCheckLabel.setVisible(false);
        mailCheckLabel.setFont(new java.awt.Font("Helvetica Neue", 1, 15)); // NOI18N
        mailCheckLabel.setForeground(new java.awt.Color(255, 51, 51));
        mailCheckLabel.setText("    Indirizzo non valido!");
        warningLabelsPanel.add(mailCheckLabel);

        idCheckLabel.setVisible(false);
        idCheckLabel.setFont(new java.awt.Font("Helvetica Neue", 1, 15)); // NOI18N
        idCheckLabel.setForeground(new java.awt.Color(255, 51, 51));
        idCheckLabel.setText("    User id non valido!");
        warningLabelsPanel.add(idCheckLabel);

        mainGridPanel.add(warningLabelsPanel);

        jPanel3.add(mainGridPanel, java.awt.BorderLayout.CENTER);

        mainPanel.add(jPanel3, java.awt.BorderLayout.CENTER);

        lowPanel.setOpaque(false);
        lowPanel.setPreferredSize(new java.awt.Dimension(600, 150));
        lowPanel.setLayout(new java.awt.BorderLayout());

        passwordPanel.setOpaque(false);
        passwordPanel.setLayout(new java.awt.GridLayout(1, 5));

        passwordLabel.setFont(new java.awt.Font("Helvetica Neue", 0, 18)); // NOI18N
        passwordLabel.setForeground(new java.awt.Color(255, 255, 255));
        passwordLabel.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
        passwordLabel.setText("PASSWORD    ");
        passwordPanel.add(passwordLabel);

        passwordTextField.setText("jPasswordField1");
        passwordTextField.setPreferredSize(new java.awt.Dimension(180, 30));
        passwordPanel.add(passwordTextField);

        controlloLabel.setFont(new java.awt.Font("Helvetica Neue", 0, 18)); // NOI18N
        controlloLabel.setForeground(new java.awt.Color(255, 255, 255));
        controlloLabel.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
        controlloLabel.setText("CONTROLLO PSW    ");
        passwordPanel.add(controlloLabel);

        controlloTextField.setText("jPasswordField2");
        controlloTextField.setPreferredSize(new java.awt.Dimension(180, 30));
        passwordPanel.add(controlloTextField);

        passwordCheckLabel.setVisible(false);
        passwordCheckLabel.setFont(new java.awt.Font("Helvetica Neue", 1, 15)); // NOI18N
        passwordCheckLabel.setForeground(new java.awt.Color(255, 51, 51));
        passwordCheckLabel.setText("    Password non valida!");
        passwordPanel.add(passwordCheckLabel);

        lowPanel.add(passwordPanel, java.awt.BorderLayout.CENTER);

        buttonsPanel.setOpaque(false);
        buttonsPanel.setPreferredSize(new java.awt.Dimension(900, 120));
        buttonsPanel.setLayout(new java.awt.GridBagLayout());

        registratiButton.setText("Registrati");
        registratiButton.setPreferredSize(new java.awt.Dimension(180, 60));
        registratiButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                registratiButtonActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.insets = new java.awt.Insets(0, 28, 0, 28);
        buttonsPanel.add(registratiButton, gridBagConstraints);

        closeButton.setText("Chiudi");
        closeButton.setPreferredSize(new java.awt.Dimension(180, 60));
        closeButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                closeButtonActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.insets = new java.awt.Insets(0, 24, 0, 24);
        buttonsPanel.add(closeButton, gridBagConstraints);

        lowPanel.add(buttonsPanel, java.awt.BorderLayout.PAGE_START);

        mainPanel.add(lowPanel, java.awt.BorderLayout.PAGE_END);

        add(mainPanel, java.awt.BorderLayout.CENTER);
    }// </editor-fold>//GEN-END:initComponents

    private void closeButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_closeButtonActionPerformed
        mainWindow.cleanUpMainPanel();
    }//GEN-LAST:event_closeButtonActionPerformed

    private void registratiButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_registratiButtonActionPerformed
        EngineRegistration engineRegistration = new EngineRegistration(EMOTIONALSONGS.userDataBase);
        
        setAllCheckOff();
        
        try {
            engineRegistration.registraNuovoUtente(
                    idTextField.getText(),
                    nomeTextField.getText(),
                    cognomeTextField.getText(),
                    cfTextField.getText().toUpperCase(),
                    indirizzoTextField.getText(),
                    mailTextField.getText(),
                    String.valueOf(passwordTextField.getPassword()),
                    String.valueOf(controlloTextField.getPassword()),
                    dataDiNascitaTextField.getText()
            );
            
            if (engineRegistration.allRight) {
                mainWindow.cleanUpMainPanel();
                if(mainWindow.leftPanel instanceof GUIUnloggedMenuExpanded){
                   mainWindow.setLeftPanel(new GUILoggedMenuExpanded(mainWindow));
                } else {
                    mainWindow.setLeftPanel(new GUILeftMenuUnespanded(mainWindow));
                }
                mainWindow.setUpperBar(new GUILoggedToolBarPanel(mainWindow));
                mainWindow.update();
            }
            
            else{
                if (!engineRegistration.validCF) { cfCheckLabel.setText("Codice fiscale non valido!"); cfCheckLabel.setVisible(true); }
                if (!engineRegistration.cfNotSigned) { cfCheckLabel.setText("Codice fiscale già presente nel sistema!");cfCheckLabel.setVisible(true); }
                if (!engineRegistration.validNome) { nomeCheckLabel.setVisible(true); }
                if (!engineRegistration.validCognome) { cognomeCheckLabel.setVisible(true); }
                if (!engineRegistration.validDataNascita) { dataDiNascitaCheckLabel.setVisible(true); }
                if (!engineRegistration.validIndirizzo) { indirizzoCheckLabel.setVisible(true); }
                if (!engineRegistration.validEmail) { mailCheckLabel.setVisible(true); }
                if (!engineRegistration.validPassword && engineRegistration.passwordMatches) { passwordCheckLabel.setText("Password non valida!"); passwordCheckLabel.setVisible(true); }
                if (!engineRegistration.passwordMatches && engineRegistration.validPassword) { passwordCheckLabel.setText("Password non coincidono!"); passwordCheckLabel.setVisible(true); }
                if (!engineRegistration.passwordMatches && !engineRegistration.validPassword) { passwordCheckLabel.setText("Password non valide, ne coincidenti!"); passwordCheckLabel.setVisible(true);  }
                if (!engineRegistration.validUserId) { idCheckLabel.setText("User id non valido!");idCheckLabel.setVisible(true);}
                if (!engineRegistration.idNotTaken) { idCheckLabel.setText("User id già preso da un altro utente!"); idCheckLabel.setVisible(true); }
            
                mainWindow.update();
            }
        } catch (IOException ex) {
            System.err.println(ex.getMessage());
        }
        
    }//GEN-LAST:event_registratiButtonActionPerformed
    
    private void setAllCheckOff(){
        cfCheckLabel.setVisible(false);
        cfCheckLabel.setText("Codice fiscale non valido!");cfCheckLabel.setVisible(false);
        nomeCheckLabel.setVisible(false);
        cognomeCheckLabel.setVisible(false);
        indirizzoCheckLabel.setVisible(false);
        mailCheckLabel.setVisible(false);
        passwordCheckLabel.setVisible(false);
        idCheckLabel.setVisible(false);
        
    }
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel buttonsPanel;
    private javax.swing.JLabel cfCheckLabel;
    private javax.swing.JLabel cfLabel;
    private javax.swing.JTextField cfTextField;
    private javax.swing.JButton closeButton;
    private javax.swing.JLabel cognomeCheckLabel;
    private javax.swing.JLabel cognomeLabel;
    private javax.swing.JTextField cognomeTextField;
    private javax.swing.JLabel controlloLabel;
    private javax.swing.JPasswordField controlloTextField;
    private javax.swing.JLabel dataDiNascitaCheckLabel;
    private javax.swing.JLabel dataDiNascitaLabel;
    private javax.swing.JTextField dataDiNascitaTextField;
    private javax.swing.JPanel iconPanel;
    private javax.swing.JLabel idCheckLabel;
    private javax.swing.JLabel idLabel;
    private javax.swing.JTextField idTextField;
    private javax.swing.JLabel indirizzoCheckLabel;
    private javax.swing.JLabel indirizzoLabel;
    private javax.swing.JTextField indirizzoTextField;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel labelsPanel;
    private javax.swing.JPanel lowPanel;
    private javax.swing.JLabel mailCheckLabel;
    private javax.swing.JLabel mailLabel;
    private javax.swing.JTextField mailTextField;
    private javax.swing.JPanel mainGridPanel;
    private javax.swing.JPanel mainPanel;
    public javax.swing.JLabel nomeCheckLabel;
    private javax.swing.JLabel nomeLabel;
    private javax.swing.JTextField nomeTextField;
    private javax.swing.JLabel passwordCheckLabel;
    private javax.swing.JLabel passwordLabel;
    private javax.swing.JPanel passwordPanel;
    private javax.swing.JPasswordField passwordTextField;
    private javax.swing.JButton registratiButton;
    private javax.swing.JPanel textFieldsLabel;
    private javax.swing.JPanel warningLabelsPanel;
    // End of variables declaration//GEN-END:variables
}
